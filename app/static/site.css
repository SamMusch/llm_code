:root{
  /* User preferences (defaults requested) */
  --accent: #a281ee;      /* rgb(162,129,238) */
  --toggle-bg: #eef5ff;   /* rgb(238,245,255) */
  --chat-bg: #ffffff;     /* rgb(255,255,255) */

  /* Derived primary tokens */
  --primary: var(--accent);
  --primaryHover: color-mix(in srgb, var(--accent) 85%, #000);
  --ring: color-mix(in srgb, var(--accent) 25%, transparent);


/* Fallback tokens (used if data-mode not set yet) */
--bg-page: #f8fafc;        /* slate-50 */
--bg-panel: #ffffff;
--bg-sidebar: #ffffff;
--border: #e5e7eb;         /* slate-200 */
--text-main: #0f172a;      /* slate-900 */
--text-muted: #64748b;     /* slate-500 */
}
html[data-theme="blue"]{
  --accent:#2563eb;        /* blue-600 */
}
html[data-theme="emerald"]{
  --accent:#059669;        /* emerald-600 */
}

/* ==============================
   Appearance (light / dark / system)
   app.js sets:
   - html[data-appearance] = light | dark | system
   - html[data-mode] = effective light | dark
   ============================== */

/* Light mode tokens */
html[data-mode="light"]{
  --bg-page: #f8fafc;        /* slate-50 */
  --bg-panel: #ffffff;
  --bg-sidebar: #ffffff;
  --border: #e5e7eb;         /* slate-200 */
  --text-main: #0f172a;      /* slate-900 */
  --text-muted: #64748b;     /* slate-500 */
}

/* Dark mode tokens */
html[data-mode="dark"]{
  --bg-page: #0b1220;        /* near slate-950 */
  --bg-panel: #0f172a;       /* slate-900 */
  --bg-sidebar: #020617;     /* slate-950 */
  --border: #1e293b;         /* slate-800 */
  --text-main: #e5e7eb;      /* slate-200 */
  --text-muted: #94a3b8;     /* slate-400 */
  --chat-bg: #0f172a;        /* default chat bg in dark unless user overrides */
}

/* ==============================
   Background style (matching / gray)
   app.js sets html[data-bg]
   ============================== */

/* Matching = panels inherit user chat background */
html[data-bg="matching"]{
  --bg-chat: var(--chat-bg);
}

/* Gray = neutral gray chat background like ChatGPT */
html[data-bg="gray"]{
  --bg-chat: var(--toggle-bg);
}

/* Dark + gray combo */
html[data-mode="dark"][data-bg="gray"]{
  --bg-chat: #020617;        /* slate-950 */
}

/* ==============================
   Apply tokens to app layout
   ============================== */

/* Page + panels */
html[data-mode] body{ background: var(--bg-page); color: var(--text-main); }

aside[aria-label="Sidebar"]{
  background: var(--bg-sidebar) !important;
  color: var(--text-main);
}

header, footer{
  background: var(--bg-panel) !important;
  border-color: var(--border) !important;
}

/* Chat surface */
#chatMessages{
  background: var(--bg-chat);
}

/* Assistant bubbles */
#chatMessages .bg-white{
  background: var(--bg-panel) !important;
  color: var(--text-main) !important;
  border-color: var(--border) !important;
}

/* Borders + muted text */
.border-slate-200{ border-color: var(--border) !important; }
.text-slate-500{ color: var(--text-muted) !important; }

/* Preserve full-bleed behavior used by base.html */
body.full-bleed { overflow: hidden; }

/* Primary button helper (used in app.html) */
.btn-primary{
  background: var(--primary);
  color: #fff;
}
.btn-primary:hover{ background: var(--primaryHover); }
.btn-primary:focus-visible{ box-shadow: 0 0 0 4px var(--ring); }

/* State helpers used by app.js */
.chatitem-active{
  background: var(--primary) !important;
  border-color: var(--primary) !important;
  color: #fff !important;
}
.bubble-user{
  background: var(--primary) !important;
  border-color: var(--primary) !important;
  color: #fff !important;
}

/* Ensure the chat area can scroll within the viewport */
#chatMessages{ overflow-anchor: none; }

/* Keep code blocks readable inside messages */
#chatMessages code{
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
}


/* ==============================
   Sidebar collapsed (desktop)
   app.js toggles .sidebar-collapsed on #sidebar
   ============================== */

#sidebar.sidebar-collapsed{
  width: 64px !important;
  min-width: 64px !important;
}

#sidebar.sidebar-collapsed .px-4,
#sidebar.sidebar-collapsed .px-3,
#sidebar.sidebar-collapsed .p-3,
#sidebar.sidebar-collapsed .p-4{
  padding-left: 8px !important;
  padding-right: 8px !important;
}

#sidebar.sidebar-collapsed #chatSearch,
#sidebar.sidebar-collapsed #projectList,
#sidebar.sidebar-collapsed #themeLabel,
#sidebar.sidebar-collapsed a[href="/logout"]{
  display: none !important;
}

/* Collapse: hide most text labels and section headers */
#sidebar.sidebar-collapsed .text-xs,
#sidebar.sidebar-collapsed .text-sm{
  display: none !important;
}

#sidebar.sidebar-collapsed #newChatBtn{
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* Harden the hover-only 3-dots visibility */
.chatMenuBtn{ display: none; }
.group:hover .chatMenuBtn{ display: inline-flex; }

/* ==============================
   Rightbar collapsed (desktop)
   app.js toggles .rightbar-collapsed on #rightbar
   ============================== */

#rightbar.rightbar-collapsed{
  width: 64px !important;
  min-width: 64px !important;
  max-width: 64px !important;
}

#rightbar.rightbar-collapsed .px-4,
#rightbar.rightbar-collapsed .px-3,
#rightbar.rightbar-collapsed .p-3,
#rightbar.rightbar-collapsed .p-4{
  padding-left: 8px !important;
  padding-right: 8px !important;
}

/* Collapse: hide everything except the header */
#rightbar.rightbar-collapsed > :not(#rightbarHeader){
  display: none !important;
}

/* In collapsed state, hide the title text so the rail stays clean */
#rightbar.rightbar-collapsed #rightbarTitle{
  display: none !important;
}

/* ==============================
   Settings modal readability
   ============================== */

#settingsModal{
  color: var(--text-main);
}

#settingsModal *{
  color: inherit;
}
#settingsModal .text-slate-500{ color: var(--text-muted) !important; }

#settingsModal .bg-white{
  background: var(--bg-panel) !important;
  color: var(--text-main) !important;
}

#settingsModal select,
#settingsModal input[type="text"],
#settingsModal input[type="search"]{
  background: var(--bg-panel) !important;
  color: var(--text-main) !important;
  border-color: var(--border) !important;
}